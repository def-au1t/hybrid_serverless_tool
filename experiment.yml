clusters:
  - name: "cluster-2"
    kubeconfig: "kubeconfig_cluster_2"

apps:
  - name: "cpu-1"
    image: "docker.io/jaceken/msc-cpu-processing-1"
    env:
      - name: "CPU_2_ADDRESS"
        value: "default.svc.cluster.local"
      - name: "CPU_3_ADDRESS"
        value: "default.svc.cluster.local"
      - name: "WORKLOAD"
        value: "10000000"
    resource_limits:
      cpu: "100m"
      memory: "128Mi"
    knative_limits:
      min_scale: 1
      max_scale: 5
      target_concurrency: 1

scenarios:
  - name: "scenario-1"
    stages:
      - name: "stage-1"
        apps:
          - name: "cpu-1"
            cluster: "cluster-2"
            env:
              - name: "WORKLOAD"
                value: "10000000"
        stage_duration: 120
        concurrency: 2
        app_target: "cpu-1"
      - name: "stage-2-01cpu"
        apps:
          - name: "cpu-1"
            cluster: "cluster-2"
            env:
              - name: "WORKLOAD"
                value: "10000000"
            resource_limits:
              cpu: "100m"
              memory: "128Mi"
        stage_duration: 120
        concurrency: 10
        app_target: "cpu-1"
      - name: "stage-3-02cpu"
        apps:
          - name: "cpu-1"
            cluster: "cluster-2"
            env:
              - name: "WORKLOAD"
                value: "10000000"
            resource_limits:
              cpu: "200m"
              memory: "128Mi"
        stage_duration: 120
        concurrency: 10
        app_target: "cpu-1"
